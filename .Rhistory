geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 1) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data, x = 5, y = sr_wiek , hjust=0,
label=paste0("Średni wiek: ", sr_wiek ),
family = "Ubuntu", angle = 90, colour = "#bd0026")
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 1) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2)
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 1) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2)
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2)
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data, x = 5, y = sr_wiek , hjust=0,
label = paste0("Średni wiek: ", sr_wiek )
)
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_text(data = dummy_data, x = 5, y = sr_wiek , hjust=0,
label = paste0("Średni wiek: ", sr_wiek ),
family = "Ubuntu", angle = 90, colour = "#bd0026")
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data, x = 5, y = sr_wiek , hjust=0,
label = sr_wiek, # paste0("Średni wiek: ", sr_wiek ),
family = "Ubuntu", angle = 90, colour = "#bd0026")
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data, x = sr_wiek, y = 5 , hjust=0,
label = sr_wiek, # paste0("Średni wiek: ", sr_wiek ),
family = "Ubuntu", angle = 90, colour = "#bd0026")
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
aes(x = sr_wiek, y = 5 , hjust=0),
label = sr_wiek, # paste0("Średni wiek: ", sr_wiek ),
family = "Ubuntu", angle = 90, colour = "#bd0026")
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = sr_wiek, y = 5 , hjust=0),
label = sr_wiek, # paste0("Średni wiek: ", sr_wiek ),
family = "Ubuntu", angle = 90, colour = "#bd0026")
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = sr_wiek, y = 5 , hjust=0),
label = sr_wiek, # paste0("Średni wiek: ", sr_wiek ),
family = "Ubuntu", angle = 90, colour = "#bd0026",
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = sr_wiek, y = 5 , hjust=0,
label = sr_wiek), # paste0("Średni wiek: ", sr_wiek ),
family = "Ubuntu", angle = 90, colour = "#bd0026",
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = sr_wiek, y = 5 , hjust=0,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 90, colour = "#bd0026",
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = sr_wiek, y = 16 , hjust=0,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026",
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = sr_wiek, y = 16 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026",
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = 50, y = 20 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026",
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 20 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 10,
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 20 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = ..count..), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent, expand = c(0, 0)) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 20 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = (..count..)/sum(..count..))), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent, expand = c(0, 0)) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 20 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = (..count..)/sum(..count..))), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent, expand = c(0, 0))
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = (..count..)/sum(..count..))), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent, expand = c(0, 0))
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = (..count..)/sum(..count..))), colour = "grey50", binwidth = 5)
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent, expand = c(0, 0))
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent, expand = c(0, 0)) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0))
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent ) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 20 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent ) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2)
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent ) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 0.03 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
ALL_data_sort <- ALL_data %>%
group_by(Komitet) %>%
mutate(sr_wiek = mean(Wiek)) %>%
ungroup() %>%
arrange(sr_wiek, desc(Komitet))
tmp <- ALL_data_sort %>%
mutate(Komitet = "Wszytkie komitety")
ALL_data_sort <- rbind(ALL_data_sort, tmp)
ALL_data_sort$Komitet_wr <- factor(stringr::str_wrap(ALL_data_sort$Komitet, 30),
levels = unique (stringr::str_wrap(ALL_data_sort$Komitet, 30)))
dummy_data <- ALL_data_sort %>%
group_by(Komitet_wr) %>%
summarise(sr_wiek = mean(Wiek))
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent ) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 0.03 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_bar(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent )
ggplot(ALL_data_sort, aes(Wiek)) +
geom_bar(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent ) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4)
ggplot(ALL_data_sort, aes(Wiek)) +
geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
scale_y_continuous(labels = percent ) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 0.03 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
df <- data.frame(age = runif(10, 30))
df <- data.frame(age = runuif(900, min = 10, max = 100),
group = rep(c("a", "b", "c", "d", "e", "f", "g", "h", "i"))
df <- data.frame(age = runuif(900, min = 10, max = 100),
group = rep(c("a", "b", "c", "d", "e", "f", "g", "h", "i"), 100))
rep(c("a", "b", "c", "d", "e", "f", "g", "h", "i"), 100)
runuif(900, min = 10, max = 100)
df <- data.frame(age = runif(900, min = 10, max = 100),
group = rep(c("a", "b", "c", "d", "e", "f", "g", "h", "i"), 100))
ggplot(df, aes(age)) +
geom_histogram(aes(y = (..count..)/sum(..count..)), binwidth = 5) +
scale_y_continuous(labels = percent ) +
facet_wrap(~ group, ncol = 5)
df <- data.frame(age = runif(900, min = 10, max = 100),
group = rep(c("a", "b", "c", "d", "e", "f", "g", "h", "i"), 100))
tmp <- df %>%
mutate(group = "ALL")
df <- rbind(df, tmp)
ggplot(df, aes(age)) +
geom_histogram(aes(y = (..count..)/sum(..count..)), binwidth = 5) +
scale_y_continuous(labels = percent ) +
facet_wrap(~ group, ncol = 5)
ggplot(ALL_data_sort, aes(Wiek)) +
#  geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
#  scale_y_continuous(labels = percent ) +
geom_histogram(aes(y = (..count..), colour = "grey50", binwidth = 5) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 0.03 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
ggplot(ALL_data_sort, aes(Wiek)) +
#  geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
#  scale_y_continuous(labels = percent ) +
geom_histogram(aes(y = (..count..)), colour = "grey50", binwidth = 5) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 0.03 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
#wykres
p =
ggplot(ALL_data_sort, aes(Wiek)) +
#  geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
#  scale_y_continuous(labels = percent ) +
geom_histogram(aes(y = (..count..)), colour = "grey50", binwidth = 5) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 20 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
geom_density(aes(y = ..density..* 600 / 11), colour = "#bd0026", fill =  "#bd0026", alpha = 0.1 ) +
labs(title="\nRozkład wieku kandydatów w wyborach do Rady Miasta 2018",
subtitle = paste0("Na podstawie danych dla 7 okręgów wyborczych miasta Wrocław"),
x = "Wiek",
y = "Ilość kandydatów",
caption = "Autor: WroData | Źródło: wybory2018.pkw.gov.pl" ) +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=20),
axis.text=element_text(family=czcionka, size=18),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(ALL_data_sort, aes(Wiek)) +
#  geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
#  scale_y_continuous(labels = percent ) +
geom_histogram(aes(y = (..count..)), colour = "grey50", binwidth = 5) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 20 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
#geom_density(aes(y = ..density..* 600 / 11), colour = "#bd0026", fill =  "#bd0026", alpha = 0.1 ) +
labs(title="\nRozkład wieku kandydatów w wyborach do Rady Miasta 2018",
subtitle = paste0("Na podstawie danych dla 7 okręgów wyborczych miasta Wrocław"),
x = "Wiek",
y = "Ilość kandydatów",
caption = "Autor: WroData | Źródło: wybory2018.pkw.gov.pl" ) +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family=czcionka, size=20),
axis.text=element_text(family=czcionka, size=18),
plot.title=element_text(size=25,family=czcionka, color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
ggplot(ALL_data_sort, aes(Wiek)) +
#  geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
#  scale_y_continuous(labels = percent ) +
geom_histogram(aes(y = (..count..)), colour = "grey50", binwidth = 5) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 20 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
#geom_density(aes(y = ..density..* 600 / 11), colour = "#bd0026", fill =  "#bd0026", alpha = 0.1 ) +
labs(title="\nRozkład wieku kandydatów w wyborach do Rady Miasta 2018",
subtitle = paste0("Na podstawie danych dla 7 okręgów wyborczych miasta Wrocław"),
x = "Wiek",
y = "Ilość kandydatów",
caption = "Autor: WroData | Źródło: wybory2018.pkw.gov.pl" ) +
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family= "Ubuntu", size=20),
axis.text=element_text(family= "Ubuntu", size=18),
plot.title=element_text(size=25,family= "Ubuntu", color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
Theme <-  theme(legend.position="bottom",
legend.key.width = unit(1,"cm"),
legend.title = element_blank(),
legend.background = element_rect(fill = "#f5f5f2", color = NA),
legend.text       = element_text(family = "Ubuntu", size = 12, hjust = 0, color = "#22211d"),
#axis.title   = element_text(family = "Ubuntu", size = 14, color = "#22211d"),
#axis.title   = element_blank(),
#axis.text.y  = element_blank(),
#axis.ticks.y = element_blank(),
#axis.ticks.x = element_text(family = "Ubuntu", size = 11, color = "#22211d"),
text = element_text(family = "Ubuntu", size = 10, color = "#22211d"),
axis.text.x  = element_text(family = "Ubuntu", size = 10, color = "#22211d"),
axis.text.y  = element_text(family = "Ubuntu", size = 13, color = "#22211d"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.background  = element_rect(fill = "#f5f5f2",  color = NA),
panel.background = element_rect(fill = "#f5f5f2",  color = NA),
plot.title    = element_text(family = "Ubuntu", size = 21,  hjust = 0.5,  color = "#4e4d47"),
plot.subtitle = element_text(family = "Ubuntu", size = 13,  hjust = 0.01,  face = "italic", color = "#4e4d47"),
plot.caption  = element_text(family = "Ubuntu", size = 11,  hjust = 0.99, color = "#4e4d47"),
panel.border = element_blank()
)
ggplot(ALL_data_sort, aes(Wiek)) +
#  geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
#  scale_y_continuous(labels = percent ) +
geom_histogram(aes(y = (..count..)), colour = "grey50", binwidth = 5) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 20 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE )
#geom_density(aes(y = ..density..* 600 / 11), colour = "#bd0026", fill =  "#bd0026", alpha = 0.1 ) +
labs(title="\nRozkład wieku kandydatów w wyborach do Rady Miasta 2018",
subtitle = paste0("Na podstawie danych dla 7 okręgów wyborczych miasta Wrocław"),
x = "Wiek",
y = "Ilość kandydatów",
caption = "Autor: WroData | Źródło: wybory2018.pkw.gov.pl" ) +
Theme
p =
ggplot(ALL_data_sort, aes(Wiek)) +
#  geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
#  scale_y_continuous(labels = percent ) +
geom_histogram(aes(y = (..count..)), colour = "grey50", binwidth = 5) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 20 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE ) +
#geom_density(aes(y = ..density..* 600 / 11), colour = "#bd0026", fill =  "#bd0026", alpha = 0.1 ) +
labs(title="\nRozkład wieku kandydatów w wyborach do Rady Miasta 2018",
subtitle = paste0("Na podstawie danych dla 7 okręgów wyborczych miasta Wrocław"),
x = "Wiek",
y = "Ilość kandydatów",
caption = "Autor: WroData | Źródło: wybory2018.pkw.gov.pl" ) +
Theme
theme(panel.background = element_rect(fill = Kolor_tla),
plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
panel.grid.minor = element_blank(), #mniejsza siatka
panel.border = element_blank(), #osie
#        panel.border=element_rect(color="black"),
axis.title=element_text(family= "Ubuntu", size=20),
axis.text=element_text(family= "Ubuntu", size=18),
plot.title=element_text(size=25,family= "Ubuntu", color="black", hjust = 0.5),
plot.margin = unit(c(0,0,0,0), "lines"))
p =
ggplot(ALL_data_sort, aes(Wiek)) +
#  geom_histogram(aes(y = (..count..)/sum(..count..)), colour = "grey50", binwidth = 5) +
#  scale_y_continuous(labels = percent ) +
geom_histogram(aes(y = (..count..)), colour = "grey50", binwidth = 5) +
coord_cartesian(xlim = c(18, 80), expand = c(0, 0)) +
facet_wrap(~ Komitet_wr, ncol = 4) +
geom_vline(data = dummy_data, aes(xintercept = sr_wiek),
colour = "#bd0026", linetype = 2) +
geom_text(data = dummy_data,
mapping = aes(x = (18 + 80) / 2, y = 20 , hjust = 0.5,
label = paste0("Średni wiek: ", round(sr_wiek, 0) )),
family = "Ubuntu", angle = 0, colour = "#bd0026", size = 5,
inherit.aes = FALSE ) +
#geom_density(aes(y = ..density..* 600 / 11), colour = "#bd0026", fill =  "#bd0026", alpha = 0.1 ) +
labs(title="\nRozkład wieku kandydatów w wyborach do Rady Miasta 2018",
subtitle = paste0("Na podstawie danych dla 7 okręgów wyborczych miasta Wrocław"),
x = "Wiek",
y = "Ilość kandydatów",
caption = "Autor: WroData | Źródło: wybory2018.pkw.gov.pl" ) +
Theme
#   theme(panel.background = element_rect(fill = Kolor_tla),
#         plot.background=element_rect(fill=Kolor_tla), #tło najbardziej na zwenątrz
#         panel.grid.major = element_line(linetype="solid",color="grey95"), #większa siatka
#         panel.grid.minor = element_blank(), #mniejsza siatka
#         panel.border = element_blank(), #osie
#         #        panel.border=element_rect(color="black"),
#         axis.title=element_text(family= "Ubuntu", size=20),
#         axis.text=element_text(family= "Ubuntu", size=18),
#         plot.title=element_text(size=25,family= "Ubuntu", color="black", hjust = 0.5),
#         plot.margin = unit(c(0,0,0,0), "lines"))
a = 9
png(filename = paste("W2.png", sep=""),
bg="white", width = a * 1.5, height = a, units = 'in', res = 150)
plot(p)
dev.off()
plot(p)
